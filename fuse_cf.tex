
\documentclass[conference]{IEEEtran}


% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation can
% be obtained at: 
% http://www.ctan.org/tex-archive/macros/latex/required/graphics/
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found as epslatex.ps or
% epslatex.pdf at: http://www.ctan.org/tex-archive/info/
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex

% correct bad hyphenation here
\hyphenation{}

\usepackage{cite}


\begin{document}
%
% paper title
% can use linebreaks \\ within to get better formatting as desired
\title{Recommending Functions in Spreadsheets from the Fuse Corpus}


% author names and affiliations
% use a multiple column layout for up to three different
% affiliations
\author{\IEEEauthorblockN{Shaown Sarker, Emerson Murphy-Hill}
\IEEEauthorblockA{Department of Computer Science\\
NC State University\\
Raleigh, North Carolina\\
Email: \{ssarker, emurph3\}@ncsu.edu}
}

% conference papers do not typically use \thanks and this command
% is locked out in conference mode. If really needed, such as for
% the acknowledgment of grants, issue a \IEEEoverridecommandlockouts
% after \documentclass

% for over three affiliations, or if they all won't fit within the width
% of the page, use this alternative format:
% 
%\author{\IEEEauthorblockN{Michael Shell\IEEEauthorrefmark{1},
%Homer Simpson\IEEEauthorrefmark{2},
%James Kirk\IEEEauthorrefmark{3}, 
%Montgomery Scott\IEEEauthorrefmark{3} and
%Eldon Tyrell\IEEEauthorrefmark{4}}
%\IEEEauthorblockA{\IEEEauthorrefmark{1}School of Electrical and Computer Engineering\\
%Georgia Institute of Technology,
%Atlanta, Georgia 30332--0250\\ Email: see http://www.michaelshell.org/contact.html}
%\IEEEauthorblockA{\IEEEauthorrefmark{2}Twentieth Century Fox, Springfield, USA\\
%Email: homer@thesimpsons.com}
%\IEEEauthorblockA{\IEEEauthorrefmark{3}Starfleet Academy, San Francisco, California 96678-2391\\
%Telephone: (800) 555--1212, Fax: (888) 555--1212}
%\IEEEauthorblockA{\IEEEauthorrefmark{4}Tyrell Inc., 123 Replicant Street, Los Angeles, California 90210--4321}}


% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}

% make the title area
\maketitle


\begin{abstract}
% TODO: should I refer to MS Excel instead of spreadsheets in certain places?
The most common form of end-user programming software is spreadsheets. Despite spreadsheets having a large array of functions built-in, most of these functions are underused. To address this, we investigate recommender system technology and present a collaborative filtering based function recommender system for spreadsheets. Our evaluation shows that the recommender system performs significantly better in comparison with a most popular algorithm based system. In this paper, we discuss the implementation of the system and the evaluation process, and finally discuss the results of the evaluation.
\end{abstract}


% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle

\section{Introduction}

Spreadsheets are the most common form of  end-user programming software. According to a study in 2005~\cite{scaffidi2005estimating}, nearly 23 million Americans use spreadsheets, constituting 30\% of the workforce. The use of spreadsheets is also very common in industry for analytical purposes. Winston~\cite{winston2001executive} estimates that around 90\% of all analysts in industry perform calculations in spreadsheets. From a spreadsheet user's perspective, formulas can be viewed as program fragments as formulas can contain programming constructs such as variables, conditional statements, and references to other parts of the spreadsheet. It is important that these end-user programmers using spreadsheet makes efficient use of the functionality available to them \texttt{[Citation needed?]}.

In Microsoft Excel, there are almost 350 unique functions, (472 in Microsoft Excel 2013 including the compatibility functions\footnote{https://support.office.com/en-us/article/Excel-functions-by-category-5f91f4e9-7b42-46d2-9bd1-63f26a86c0eb}). But, most of these are rarely used \texttt{[Citation needed?]}. To facilitate these very large number of spreadsheet analysts to use these functions, it is viable that we explore effective function recommendation in spreadsheets.

Researchers have been assembling and preserving spreadsheet corpora for the purpose of better understanding of end-user activities and designing tools to assist them~\cite{fisher2005euses, hermans2014enron}. In this paper, we look into Fuse~\cite{barik2015fuse}, the largest reproducible spreadsheet corpus known to date. We applied a slightly modified version of the collaborative filtering algorithm on the spreadsheets in Fuse to get function recommendations for an input spreadsheet. We evaluated the performance of our system against another commonly used recommender algorithm and found out that our collaborative filtering-based recommendation system recommends functions in spreadsheet by \texttt{insert future calculated percentage here}. 

The remainder of the paper is structured as follows. We first review previous work on recommendation systems in softwares and related work on making spreadsheet formula usage efficient (Section II). We then provide details of the spreadsheet corpus used for our system and the details of the algorithm used (Section III) before describing our evaluation measures (Section IV) and their outcome (Section V). We discuss the various aspects of our system (Section VI) along with the limitations and future works (Section VII) based on our contribution in this paper afterwards.

\section{Related Work}
Recommender systems are used generally to produce a list of predictions based on the preference of an user and the similarity of preferences of other users. Recommender systems assist users by recommending  products and services to her based on her past preference in a scenario where the number of available options are extremely large. In recent years, recommender systems have become quite popular and have been applied successfully in multiple sectors of business and academia~\cite{hill1995recommending, resnick1994grouplens,shardanand1995social}. 

Collaborative filtering is one of the most prominent recommending technologies available. The core concept of collaborative filtering is to apply a nearest neighbor method between a user's preferences and the preference of a large user community, and provide the user with recommendations by extrapolating based on how her selection or preference relate to that of the community. Collaborative filtering has been applied to recommend a fringe of products and services, ranging from movies to school courses~\cite{miller2003movielens, resnick1994grouplens, linden2003amazon, liu2003adaptive, mcnee2006don, farzan2006social, hsu2008personalized}. 

However, there has been little effort to use recommendation systems to help users of a large   software system with vast set of functionality to learn these functionalities. One of the notable attempts to use recommender systems to recommend command is the OWL~\cite{linton2000owl}, which makes command recommendations to Microsoft Word users. OWL recommends commands to an individual if she is not using certain commands at all but the community is using them on a frequent basis.

Matejka and colleagues developed a collaborative filtering-based approach to recommend commands in AutoCAD, a computer aided drafting software, called CommunityCommands~\cite{matejka2009communitycommands}. The researchers of CommunityCommands showed that the collaborative filtering derived command recommendations were preferred by the AutoCAD users over the history based recommendation approach used in OWL.

In this paper, we build on these prior works by applying the concept of recommender systems to recommend functions in spreadsheets. We use the Fuse spreadsheet corpus as a source of function usage preference of the spreadsheet users' community and recommend functions contextualized to an individual user by applying collaborative filtering algorithm.

\section{Methodology}
According to the formal definition, collaborative filtering is a method of making automatic predictions (filtering) about the interests of a user by collecting preferences or taste information from many users (collaborating) \footnote{https://en.wikipedia.org/wiki/Collaborative\_filtering}. Although collaborative filtering can be applied in many ways, most approaches falling under the category of user-based collaborative filtering are composed of mainly two distinct steps - find the users with similar preference patterns to that of the input user and then use the preference of the similar users to obtain predictions for the input user.

To apply this technique, we need to measure the similarity between two users. In order to do so, we define a vector for each user's spreadsheets and compare the vectors to find the similar preferences. Our function vector is defined such that the vector $V$ for an individual user consists of cells, where each cell $V_i$ represents the usage frequency of the function $f_i$.

To generate the input user's vector we extract function usage frequencies from multiple files created by the user. The more spreadsheets created by the same user is given as input the better representative vector for the user we get. As for the potential pool of similar user vectors, we decided to use Fuse, a spreadsheet corpus containing nearly 250 thousand unique spreadsheets extracted from the Common Crawl\footnote{http://www.commoncrawl.org} index~\cite{barik2015fuse}. The authors of Fuse also extracted meta information such as created by and function usage frequencies. We classified the spreadsheet meta information and discarded any spreadsheet that did not use any function. This reduced the number of spreadsheets under consideration to less than 13 thousand. These spreadsheets were then grouped by the user name \texttt{(There are a large number of spreadsheets where this information is not present, how do we refer to them in the paper?)}. We proceeded to extract the function vector from each of these groups in the similar way the input user vector was extracted. The final number of function vectors in this pool of potential similar user vectors was \texttt{insert actual number from modified code here}.

To measure the similarity between users, we used the cosine similarity function, which measures the cosine of the angle between the user's vectors as described above. Given the function vector for two users $i$ and $j$ as $V_i$ and $V_j$ respectively, the similarity function is:

\begin{center}
	\[
	similarity(i, j) = \cos({}_{V_i}\theta_{V_j}) = \frac{V_i \cdot V_j}{||V_i|| ||V_j||} = \frac{\sum_{k=1}^{n} V_{i_k}V_{j_k}}{\sqrt{\sum_{k=1}^{n} {V_{i_k}}^2  {V_{j_k}}^2}}
	\]
\end{center}

When the similarity function evaluates closer to 0, the vectors are substantially orthogonal to each other, which indicates that the users are dissimilar. A similarity function value of closer to 1, indicates that the vectors are nearly collinear and the users are quite similar. For ease of our implementation we used the complement of the cosine similarity: $1 - similarity(i,j)$, which is often commonly referred to as \textit{cosine distance}.

To find the similar user vectors for the given vector, we calculated the similarity function value between each of the vector in the pool and the input vector, after this the vectors in the pool were sorted based on their cosine distance in ascending order. We selected $n$ most similar vectors from this ordered list, where $n$ is a tuning parameter, which in our case was between 3 and 5.

We compare the frequencies of each individual function between each of the similar vector and the input vector, and add a function to the recommendation set only if the function had a frequency value in one of the similar vectors but not in the input vector. The set of recommended functions is then ordered by the cumulative frequency of the functions in the similar vectors, this way the functions in the recommendation list appear in order of their usage in the similar vectors.

\section{Evaluation}

%TODO possible subsections like automated evaluation (leave k-out evaluation and online evaluation)

\section{Results}

\section{Discussion}
%TODO consider naming it to contribution and/or merging it with Results secion.

\section{Limitations \& Future Work}

\section*{Acknowledgment}
%TODO acknowledgements if any (LAS information maybe?)


% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
\bibliography{fuse_cf}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)





% that's all folks
\end{document}
